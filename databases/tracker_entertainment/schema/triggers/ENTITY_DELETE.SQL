SET TERM !! ;

CREATE OR ALTER TRIGGER ENTITY_DELETE FOR ENTITY
ACTIVE BEFORE DELETE POSITION 0
AS
BEGIN
  IF ((EXISTS(SELECT 1 FROM PLATFORM WHERE ENTITYID = OLD.ID)) OR (EXISTS(SELECT 1 FROM PRODUCTION WHERE ENTITYID = OLD.ID))) THEN EXCEPTION DATA_LINKED 'This entity has linked records and cannot be deleted.';
END
!!

SET TERM ; !!